<?= $this->javascript("projax/js/prototype.js"); ?>
<script type="text/javascript">
     function toggle_selection(id, text) {
      if (Element.hasClassName(id, 'selected')) {
	Element.removeClassName(id, 'selected');
	//remove from list
	Element.remove(id + '_list');
	Element.remove(id + '_input');
      } else {
	new Insertion.Bottom('user_fields', '<li id="' + id + '_list">' + text + '</li>');
	new Insertion.Before('save_button',
			     '<input id="' + id + '_input" type="hidden" name="fields[]" value="'
			     + id + ' ' + text + '"/>');
	Element.addClassName(id, 'selected');
      }
}
</script>     

<style type="text/css">
a.selected { background-color:yellow; }
</style>
<p><b>Edit Research Fields</b></p>

<ul id="user_fields">
     <? foreach ($this->etd->mods->researchfields as $field): ?>
        <li id="#<?= $field->id ?>_list"><?= $field->topic ?></li>
     <? endforeach ?>
</ul>     

<form method="post" id="fields_form"  action="<?= $this->url(array("action" => "saveResearchfield"))?>">
  <? foreach ($this->etd->mods->researchfields as $field): ?>
     <input id="#<?= $field->id ?>_input" type="hidden" name="fields[]"
       value="#<?= $field->id ?> <?= $field->topic ?>"/>
   <? endforeach ?>
   <input id="save_button" type="submit" value="save"/>
</form>
<br/>


<p><b>UMI ProQuest Research Fields</b></p>
<div id="browse_all" style="height:300px;overflow:auto;border:1px solid grey;">
<? foreach ($this->fields->members as $this->field): ?>
  <?=  $this->render('edit/_researchfield.phtml'); /* recursive */ ?>
<? endforeach ?>
</div>
