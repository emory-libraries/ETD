INSTALLATION NOTES
==================
ETD requires that fedora-commons be configured as follows:
   - RIsearch enabled, with sync updates turned on
   - xacml enforcement enabled and combining algorithm set to ordered, permit overrides 
   (set XACML-COMBINING-ALGORITHM to com.sun.xacml.combine.OrderedPermitOverridesPolicyAlg
   in fedora.fcfg)
 - etd repository-wide policies (in src/fedora-policies) should be
   included in xacml policies, and default policy to allow all API-A
   should be disabled.  Recommended: check this out of svn and replace
   default fedora xacml policies https://svn.library.emory.edu/svn/fedora/repository-policies/  
 - Fedora 3.x requires a patch to allow cmodel xacml filtering
 - working LDAP authentication filter
 - custom ESD DeptData filter
 - Generic Search Service installed; use index script src/public/xslt/etdFoxmlToSolr.xslt
   - Solr instance, with schema from src/scripts/solr-schema.xml
 - ETD control objects (cmodel/sdef/sdep) loaded 

Site webroot should be pointed at src/public
 - requires apache override, mod_rewrite
 - copy src/htaccess-sample to public/.htaccess and edit
 - edit config files in src/config 
    - copy *.xml.example to *.xml and edit
    - which section of the config file is loaded depends on mode
      setting in environment.xml

UPGRADE NOTES
=================

Version 1.8.3
-------------
* Run the migration scripts to add two new programs the emory college school: 
    - 018-add-programs.php
    
Version 1.8.1
-------------
* Edit the programs collection (emory:17r1x) and delete the last version of the SKOS datastream.
* Run the migration scripts to reload the rollins school data: 
    - 015-add-rollins-programs.php
    - 016-add_prog_codes_to_skos.php
* Delete all the records from etd_admins in the etd database
* Reload the data by running DB/002-load_init_data.php

Version 1.8
-----------
* Update fedora policies under FEDORA_HOME to new branch and restart Fedora:
   - staging: https://svn.library.emory.edu/svn/fedora/repository-policies/branches/etd_1.8.x
   - production: https://svn.library.emory.edu/svn/fedora/repository-policies/tags/etd_1.8
* Add etdOwner to config
* Remove honors_collection section from config.xml
* Remove collections section from config.xml
* Add etd-db.xml as specified in etd-db.xml.example file
* Run the following migrations / scripts
* 015a-add-collection_program_owners.php - Change maintenance_account to use fedoraAdmin for this migration then change back to etdmaint
   -  create_collections.php
   -  015-add-rollins-programs.php
   -  016-add-prog_codes_to_skos.php - before running this script, 
       manually edit the config.xml defined programs_pid.
       Select the SKOS datastream for edit, then add this attribute to first line:
       xmlns:dc="http://purl.org/dc/elements/1.1/"
   - DB/001-create_db_user_table.sql - See notes at top of script. You have to replace <DB NAME> and <PASSWORD> values.  Run this thru PHPMyAdmin
   - DB/002-load_init_data.php


Version 1.7
-----------
* main config.xml has new  sections for for news_feed and doc_feed
* persis.xml test section has changed
* Run following migrations:
   - 014-remove_duplicate_collection_membership.php
* Run a “forced refresh” on the fedora OAI provider


Version 1.6
-----------
* Changes to main config file (see config.xml.example)
   - make sure contact email name field is now required (reply-to for emails)
   - new report viewer department should be set
   - honors admin section is no longer needed, and should be removed
* Run the following migration scripts:
   - 012-add-candler-programs.php - update program hierarchy for Candler
   - 013-update_dc - Update the Dublin Core for all ETDs using the latest MODS -> DC conversion
* Publication script has changed; weekly cron job that runs
   publish.php should be revised to send the output to a log file.
* solr schema and indexing has changed, both should be updated:
   - restart solr (etd solr schema should be a symlink to copy in etd svn)
   - re-index all fedora objects with Fedora GSearch
* update fedora xacml policies from latest svn


Version 1.5
-----------
* latest version of ETD cmodel & new service objects must be loaded to Fedora
* update fedora xacml policies from latest svn
* run migration 011
* update gsearch & solr to latest xslt index & solr schema, reindex
* recommended: configure gsearch to include etd xslt to simplify
   future updates, use symlink for solr schema
* config/fedora.xml now requires pidspace for running tests
* if connecting to fedora as localhost, add alternate hostnames to
   config/fedora.xml (new html service will only respond to requests
   from configured fedora instance)

Version 1.4
-----------
* run migrations 006-010
* update gsearch & solr to latest xslt index & solr schema, reindex


Version 1.2
-----------
* run migration: 005-add_program_ids.php 
* update gsearch & solr to latest xslt index & solr schema, reindex

Version 1.0
-----------
* run update_rights_statement.php, clean_xacml.php after updating


Version 0.9.5
-------------
* update gsearch & solr to latest xslt index & solr schema


Version 0.9.4
-------------
* install ESD Fedora filter for graduate program coordinator permissions
* run clean_xacml script to fix/update xacml on all etd records
* update gsearch to latest solr schema & index xslt
* set path for logfile in config.xml; needs to be readable and writable by apache
